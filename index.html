<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  </head>
  <body>
    <!-- Bouton de téléchargement -->
    <button id="downloadBtn" style="position:absolute; top:10px; left:10px; z-index:999;">
      telecharger le modele 3d
    </button>

    <!-- Bouton arrêt / reprise rotation -->
    <button id="toggleRotationBtn" style="position:absolute; top:50px; left:10px; z-index:999;">
      arrêter la rotation
    </button>

    <a-scene shadow="type: pcfsoft">
      <a-entity id="global"
                rotation="0 0 0"
                animation="property: rotation; to: 0 359 0; dur: 20000; loop: true; easing: linear">

     <a-entity id="jardin1" obj-model="mtl: ./assets/jardin/jardin1.mtl; obj: ./assets/jardin/jardin1.obj" scale="0.00002 0.00002 0.00002" position="-0.2983 0.47419 -0.09083" rotation="-90 0 0" shadow="cast: true; receive: true"></a-entity>

        <a-entity id="garage"
                  gltf-model="./lycée.glb"
                  scale="0.02 0.02 0.02"
                  rotation="0 0 0"></a-entity>

        <a-entity id="position"
                  light="angle: 180; color: #EEE; type: spot; castShadow: true"
                  position="-0.34746 0.586 -0.05768"
                  animation="dir: alternate; dur: 400; easing: linear; loop: true; property: position; to: 0 0.6 0"
                  rotation="180 0 0"></a-entity>

        <a-text id="moi"
                value="realisation par \n Paglierusco Alexis 1pro4"
                text="color: #595959"
                position="1.69052 0.44462 -1.11078"
                rotation="-87.61 -95.17 9.39"
                scale="0.5 0.5 0.5"></a-text>

      </a-entity>
    </a-scene>
    
    <script>
      // Téléchargement
      const downloadBtn = document.getElementById('downloadBtn');
      downloadBtn.addEventListener('click', () => {
        const link = document.createElement('a');
        link.href = './lycée.glb';
        link.download = 'lycée.glb';
        link.click();
      });

      // Arrêt / reprise rotation
      const toggleBtn = document.getElementById('toggleRotationBtn');
      const globalEntity = document.getElementById('global');
      let rotationActive = true;

      toggleBtn.addEventListener('click', () => {
        if (rotationActive) {
          globalEntity.removeAttribute('animation');
          toggleBtn.textContent = "relancer la rotation";
        } else {
          globalEntity.setAttribute('animation',
            'property: rotation; to: 0 359 0; dur: 20000; loop: true; easing: linear'
          );
          toggleBtn.textContent = "arrêter la rotation";
        }
        rotationActive = !rotationActive;
      });

      // Ajout automatique du shadow à tous les objets
      AFRAME.scenes[0].addEventListener('loaded', () => {
        document.querySelectorAll('a-entity, a-text, a-image').forEach(el => {
          el.setAttribute('shadow', 'cast: true; receive: true');
        });
      });
    </script>
  </body>
</html>
